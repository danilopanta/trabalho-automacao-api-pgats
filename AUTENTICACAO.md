# Documentação de Autenticação JWT## Visão GeralA API de Reservas de Hotel utiliza autenticação JWT (JSON Web Token) para proteger os endpoints relacionados às reservas. O sistema permite que hóspedes registrados façam login e obtenham um token de acesso para realizar operações de reserva.## Fluxo de Autenticação### 1. Login do Hóspede```httpPOST /hospedes/loginContent-Type: application/json{  "nome": "Danilo Panta",  "senha": "senha123"}```**Resposta de Sucesso:**```json{  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",  "hospede": {    "id": 1,    "nome": "Danilo Panta",    "email": "danilo@email.com",    "telefone": "(11) 99999-9999"  }}```### 2. Uso do TokenO token recebido deve ser incluído no cabeçalho `Authorization` para acessar endpoints protegidos:```httpAuthorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...```## Endpoints ProtegidosTodos os endpoints de reserva requerem autenticação:- `GET /reservas` - Listar reservas do hóspede autenticado- `POST /reservas` - Criar nova reserva- `GET /reservas/:id` - Obter reserva específica- `PUT /reservas/:id` - Atualizar reserva- `DELETE /reservas/:id` - Cancelar reserva## Configuração do Token- **Algoritmo**: HS256- **Validade**: 24 horas- **Secret**: Configurado via variável de ambiente `JWT_SECRET` (padrão: "seu_jwt_secret_aqui")## Exemplo de Uso com Curl### 1. Fazer Login```bashcurl -X POST http://localhost:3000/hospedes/login \  -H "Content-Type: application/json" \  -d '{"nome": "Danilo Panta", "senha": "senha123"}'```### 2. Usar Token para Criar Reserva```bashcurl -X POST http://localhost:3000/reservas \  -H "Content-Type: application/json" \  -H "Authorization: Bearer SEU_TOKEN_AQUI" \  -d '{    "quartoId": 1,    "dataCheckIn": "2024-02-01",    "dataCheckOut": "2024-02-05"  }'```## Tratamento de Erros### Token Inválido ou Expirado```json{  "error": "Token inválido"}```**Status Code**: 401 Unauthorized### Token Ausente```json{  "error": "Token não fornecido"}```**Status Code**: 401 Unauthorized### Credenciais Inválidas no Login```json{  "error": "Credenciais inválidas"}```**Status Code**: 401 Unauthorized## Hóspedes Pré-cadastradosPara testes, utilize um dos hóspedes pré-cadastrados:| Nome | Senha | Email ||------|-------|-------|| Danilo Panta | senha123 | danilo@email.com || Ana Silva | senha456 | ana@email.com || Carlos Santos | senha789 | carlos@email.com |## Swagger UIA documentação interativa está disponível em `/api-docs` e inclui suporte para autenticação Bearer Token. Use o botão "Authorize" para inserir seu token JWT.## Implementação Técnica### Middleware de AutenticaçãoO middleware `authenticateToken` é responsável por:- Extrair o token do cabeçalho Authorization- Verificar a validade do token- Adicionar as informações do usuário ao objeto `req.user`### Geração de TokenOs tokens são gerados no endpoint de login usando:- Payload: `{ userId: hospede.id, nome: hospede.nome }`- Expiração: 24 horas- Assinatura: HMAC SHA256### Segurança- Senhas são criptografadas usando bcryptjs- Tokens incluem tempo de expiração- Validação rigorosa de credenciais- Acesso restrito por hóspede (cada hóspede vê apenas suas reservas)